<% content_for(:actions) do %>
  <% if logged_in? %>
    <%= link_to new_note_path do %>
      <i class="fa-solid fa-plus"></i>
    <% end %>
  <% end %>
<% end %>

<h1>
  Notes <%= "on #{params[:tag]}" if params[:tag].present? %> 
</h1>

<p>
  My personal coding journal app. Check my <a href="https://juan.gallegoiv.com">homepage</a> also.
</p>

<%= form_tag notes_path, method: :get do %>
  <%= text_field_tag :q, params[:q], type: "search" %>
  <%= submit_tag "Search" %>
<% end %>

<p>
  <strong>Browse by tag:</strong>

  <%= @tags
    .map { |tag, count| "#{link_to tag, notes_path(tag: tag)} #{count}" }
    .join(" Â· ") 
    .html_safe %>
</p>

<h2>Recent notes</h2>

<ul id="notes">
  <% @notes.each do |note| %>
    <li>
      <h3><%= link_to note.title, note %> - <%= note.created_at.strftime("%Y-%m-%d") %></h3>
      <% if note.private? %>
        <i class="fa-solid fa-lock"></i>
      <% end %>
      <%= note.tags.map { |tag| link_to "##{tag}", notes_path(tag: tag) }.join(" ").html_safe %>

      <p><%= MarkdownRenderer.convert_markdown(truncate(note.intro, length: 200)).html_safe  %></p>
    </li>
  <% end %>
</ul>
